<?xml version="1.0" encoding="UTF-8"?>
<testsuite name="ru.mai.lessons.rpks.ServiceTest" tests="18" skipped="0" failures="0" errors="0" timestamp="2023-06-14T22:32:01" hostname="mate14" time="294.113">
  <properties/>
  <testcase name="testKafkaWriteReadMessage()" classname="ru.mai.lessons.rpks.ServiceTest" time="16.783"/>
  <testcase name="testServiceFilteringNotEquals()" classname="ru.mai.lessons.rpks.ServiceTest" time="14.179"/>
  <testcase name="testServiceFilteringNotRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="23.141"/>
  <testcase name="testServiceFilteringContainsNotEqualsTwoRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="14.337"/>
  <testcase name="testServiceFilteringAddNewRule()" classname="ru.mai.lessons.rpks.ServiceTest" time="33.72"/>
  <testcase name="testServiceFilteringContainsNotContainsTwoRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.193"/>
  <testcase name="testStartPostgreSQL()" classname="ru.mai.lessons.rpks.ServiceTest" time="12.699"/>
  <testcase name="testServiceFilteringUpdateRule()" classname="ru.mai.lessons.rpks.ServiceTest" time="35.133"/>
  <testcase name="testServiceFilteringNotContains()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.523"/>
  <testcase name="testServiceFilteringEqualsNotContainsTwoRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.805"/>
  <testcase name="testServiceFilteringContains()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.279"/>
  <testcase name="testServiceFilteringEqualsContainsTwoRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.423"/>
  <testcase name="testServiceFilteringEquals()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.361"/>
  <testcase name="testPostgreSQLReadValues()" classname="ru.mai.lessons.rpks.ServiceTest" time="11.449"/>
  <testcase name="testServiceFilteringEqualsTwoRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.703"/>
  <testcase name="testServiceFilteringEqualsNotEqualsTwoRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.506"/>
  <testcase name="testServiceFilteringContainsTwoRules()" classname="ru.mai.lessons.rpks.ServiceTest" time="13.274"/>
  <testcase name="testStartKafka()" classname="ru.mai.lessons.rpks.ServiceTest" time="11.586"/>
  <system-out><![CDATA[01:32:01,086 |-INFO in ch.qos.logback.classic.LoggerContext[default] - This is logback-classic version 1.4.5
01:32:01,109 |-INFO in ch.qos.logback.classic.LoggerContext[default] - Could NOT find resource [logback-test.xml]
01:32:01,113 |-INFO in ch.qos.logback.classic.LoggerContext[default] - Found resource [logback.xml] at [file:/home/dasha/java/test2Laba_1/JavaServiceFiltering/build/resources/test/logback.xml]
01:32:01,209 |-INFO in ch.qos.logback.core.model.processor.AppenderModelHandler - Processing appender named [CONSOLE]
01:32:01,209 |-INFO in ch.qos.logback.core.model.processor.AppenderModelHandler - About to instantiate appender of type [ch.qos.logback.core.ConsoleAppender]
01:32:01,239 |-WARN in ch.qos.logback.core.ConsoleAppender[CONSOLE] - This appender no longer admits a layout as a sub-component, set an encoder instead.
01:32:01,239 |-WARN in ch.qos.logback.core.ConsoleAppender[CONSOLE] - To ensure compatibility, wrapping your layout in LayoutWrappingEncoder.
01:32:01,239 |-WARN in ch.qos.logback.core.ConsoleAppender[CONSOLE] - See also http://logback.qos.ch/codes.html#layoutInsteadOfEncoder for details
01:32:01,240 |-INFO in ch.qos.logback.classic.model.processor.LoggerModelHandler - Setting level of logger [ru.mai.lessons.rpks] to INFO
01:32:01,245 |-INFO in ch.qos.logback.classic.model.processor.LoggerModelHandler - Setting additivity of logger [ru.mai.lessons.rpks] to false
01:32:01,245 |-INFO in ch.qos.logback.core.model.processor.AppenderRefModelHandler - Attaching appender named [CONSOLE] to Logger[ru.mai.lessons.rpks]
01:32:01,246 |-INFO in ch.qos.logback.classic.model.processor.RootLoggerModelHandler - Setting level of ROOT logger to ERROR
01:32:01,246 |-INFO in ch.qos.logback.core.model.processor.AppenderRefModelHandler - Attaching appender named [CONSOLE] to Logger[ROOT]
01:32:01,246 |-INFO in ch.qos.logback.core.model.processor.DefaultProcessor@55322aab - End of configuration.
01:32:01,247 |-INFO in ch.qos.logback.classic.joran.JoranConfigurator@2b4c1d96 - Registering current configuration as safe fallback point

01:32:13.016 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Bootstrap.servers: PLAINTEXT://localhost:32801
01:32:13.019 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:32:13.252 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Creating topics
01:32:13.813 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Created topics
01:32:13.814 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Sending message
01:32:13.934 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Sent message
01:32:13.935 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Consumer subscribe
01:32:13.936 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Consumer start reading
01:32:14.042 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:32:15.142 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 9
01:32:16.244 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 8
01:32:17.254 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:32:28.533 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:32:29.390 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:32:29.860 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:32:29.890 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:32:29.979 [pool-2-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:32:29.994 [pool-2-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:32:29.994 [pool-2-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:32:30.058 [Timer-0] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:32:30.058 [pool-3-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:32:30.066 [Timer-0] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@40bcf0e8
01:32:30.237 [pool-2-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:32:31.281 [pool-2-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:32:40.058 [Timer-0] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:32:42.728 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:32:42.757 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:32:43.222 [pool-4-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:32:43.237 [pool-4-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:32:43.237 [pool-4-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:32:43.246 [Timer-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:32:43.246 [pool-5-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:32:43.484 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:32:44.584 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 9
01:32:45.685 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 8
01:32:46.787 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 7
01:32:47.887 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 6
01:32:48.989 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 5
01:32:50.089 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 4
01:32:51.190 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 3
01:32:52.291 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 2
01:32:53.246 [Timer-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:32:53.393 [pool-4-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 1
01:33:03.246 [Timer-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:06.740 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:33:06.768 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:33:07.256 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:33:07.271 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:33:07.276 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:33:07.290 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:33:07.294 [pool-6-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:33:07.310 [pool-6-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:33:07.311 [pool-6-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:07.323 [Timer-2] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:07.325 [pool-7-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:33:07.330 [Timer-2] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@4816e3b4
01:33:07.331 [Timer-2] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@46d114c6
01:33:07.595 [pool-6-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:33:08.623 [pool-6-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:33:10.069 [Timer-0] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:33:17.323 [Timer-2] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:20.666 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:33:20.692 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:33:21.180 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:33:21.196 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:33:21.202 [pool-8-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:33:21.218 [pool-8-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:33:21.219 [pool-8-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:21.228 [Timer-3] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:21.228 [pool-9-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:33:21.237 [Timer-3] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@2d620ef8
01:33:21.469 [pool-8-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:33:22.472 [pool-8-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:33:22.472 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:33:22.475 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:33:22.478 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Wait until application updated rules from DB
01:33:31.229 [Timer-3] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:31.235 [Timer-3] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@23a5e524
01:33:31.235 [Timer-3] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@279a6588
01:33:33.249 [Timer-1] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:33:41.229 [Timer-3] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:41.236 [Timer-3] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@6298ef1f
01:33:41.236 [Timer-3] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@5f30387a
01:33:42.543 [pool-8-thread-1] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:33:47.324 [Timer-2] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:33:51.229 [Timer-3] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:53.859 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:33:53.886 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:33:54.506 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:33:54.522 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:33:54.525 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:33:54.542 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:33:54.546 [pool-10-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:33:54.561 [pool-10-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:33:54.561 [pool-10-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:54.569 [Timer-4] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:33:54.569 [pool-11-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:33:54.574 [Timer-4] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@3d2aa20c
01:33:54.574 [Timer-4] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@33ed5bd9
01:33:54.820 [pool-10-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:33:55.823 [pool-10-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:34:04.569 [Timer-4] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:21.230 [Timer-3] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:34:21.623 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:34:21.645 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:34:22.120 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:34:22.132 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:34:22.136 [pool-13-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:34:22.149 [pool-13-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:34:22.149 [pool-13-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:22.156 [Timer-5] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:22.157 [pool-14-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:34:22.161 [Timer-5] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@6b8f35b8
01:34:22.532 [pool-13-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:34:23.554 [pool-13-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:34:23.559 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:34:23.563 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:34:23.567 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Wait until application updated rules from DB
01:34:32.157 [Timer-5] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:32.160 [Timer-5] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@6548d6b9
01:34:34.570 [Timer-4] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:34:42.157 [Timer-5] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:42.162 [Timer-5] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@61775ec8
01:34:43.626 [pool-13-thread-1] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:34:52.157 [Timer-5] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:55.173 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:34:55.195 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:34:55.775 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:34:55.787 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:34:55.791 [pool-15-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:34:55.805 [pool-15-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:34:55.805 [pool-15-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:55.812 [Timer-6] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:34:55.812 [pool-16-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:34:55.818 [Timer-6] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@272cfec3
01:34:56.037 [pool-15-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:34:57.051 [pool-15-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:35:05.812 [Timer-6] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:09.062 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:35:09.081 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:35:09.568 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:35:09.582 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:35:09.584 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:35:09.602 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:35:09.606 [pool-17-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:35:09.618 [pool-17-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:35:09.619 [pool-17-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:09.624 [Timer-7] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:09.624 [pool-18-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:35:09.629 [Timer-7] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@9e548fa
01:35:09.629 [Timer-7] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@722a7b6
01:35:09.870 [pool-17-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:35:10.876 [pool-17-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:35:19.624 [Timer-7] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:22.157 [Timer-5] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:35:22.431 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:35:22.449 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:35:22.901 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:35:22.913 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:35:22.917 [pool-19-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:35:22.930 [pool-19-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:35:22.930 [pool-19-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:22.936 [pool-20-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:35:22.936 [Timer-8] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:22.940 [Timer-8] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@67c3a641
01:35:23.157 [pool-19-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:35:24.165 [pool-19-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:35:32.936 [Timer-8] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:35.806 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:35:35.813 [Timer-6] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:35:35.827 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:35:36.312 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:35:36.327 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:35:36.330 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:35:36.345 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:35:36.348 [pool-21-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:35:36.360 [pool-21-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:35:36.360 [pool-21-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:36.367 [Timer-9] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:36.367 [pool-22-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:35:36.372 [Timer-9] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@62f8af32
01:35:36.372 [Timer-9] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@6c3f5d1d
01:35:36.605 [pool-21-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:35:37.612 [pool-21-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:35:46.368 [Timer-9] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:49.069 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:35:49.086 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:35:49.625 [Timer-7] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:35:49.694 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:35:49.707 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:35:49.711 [pool-23-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:35:49.728 [pool-23-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:35:49.728 [pool-23-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:49.734 [Timer-10] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:35:49.734 [pool-24-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:35:49.739 [Timer-10] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@3639c58f
01:35:49.951 [pool-23-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:35:50.963 [pool-23-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:35:59.734 [Timer-10] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:02.466 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:36:02.479 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:36:02.937 [Timer-8] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:36:14.298 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:36:14.314 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:36:14.856 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:36:14.870 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:36:14.873 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:36:14.889 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:36:14.892 [pool-26-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:36:14.903 [pool-26-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:36:14.903 [pool-26-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:14.909 [Timer-11] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:14.910 [pool-27-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:36:14.916 [Timer-11] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@8fde084
01:36:14.917 [Timer-11] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@63a1feb
01:36:15.135 [pool-26-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:36:16.149 [pool-26-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:36:16.368 [Timer-9] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:36:24.909 [Timer-11] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:27.990 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:36:28.013 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:36:28.450 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:36:28.466 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:36:28.469 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:36:28.482 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:36:28.485 [pool-28-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:36:28.497 [pool-28-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:36:28.497 [pool-28-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:28.502 [Timer-12] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:28.502 [pool-29-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:36:28.507 [Timer-12] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@6810cb9e
01:36:28.507 [Timer-12] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@66d728ec
01:36:28.717 [pool-28-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:36:29.723 [pool-28-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:36:29.735 [Timer-10] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
01:36:38.502 [Timer-12] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:41.221 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topics: [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)], replica factor 1, partitions 3
01:36:41.237 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Topic not exist. Create topics [(name=test_topic_in, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null), (name=test_topic_out, numPartitions=3, replicationFactor=1, replicasAssignments=null, configs=null)]
01:36:41.710 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:36:41.726 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:36:41.728 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Create filtering rule 1
01:36:41.746 [Test worker] INFO  ru.mai.lessons.rpks.ServiceTest - Check rule from DB
01:36:41.749 [pool-30-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Hikari config was done
01:36:41.760 [pool-30-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Created a new datasource
01:36:41.760 [pool-30-thread-1] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:41.766 [Timer-13] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:41.767 [pool-31-thread-1] INFO  r.m.l.rpks.impl.KafkaReaderImpl - Start reading kafka topic test_topic_in
01:36:41.774 [Timer-13] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@7c84b38c
01:36:41.774 [Timer-13] INFO  r.m.l.rpks.impl.ServiceFiltering - ru.mai.lessons.rpks.model.Rule@7243526c
01:36:41.995 [pool-30-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Remaining attempts 10
01:36:42.997 [pool-30-thread-2] INFO  ru.mai.lessons.rpks.ServiceTest - Read messages 1
01:36:51.766 [Timer-13] INFO  r.mai.lessons.rpks.impl.DbReaderImpl - Get datasource successfully
01:36:54.910 [Timer-11] ERROR r.mai.lessons.rpks.impl.DbReaderImpl - Connection was failed!
]]></system-out>
  <system-err><![CDATA[com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":"alex", "age":, "sex":null}"; line: 1, column: 24]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":"alex", "age":, "sex":"M"}"; line: 1, column: 24]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":"alex", "age":, "sex":"M"}"; line: 1, column: 24]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:63)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-0" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":, "age":, "sex":"M"}"; line: 1, column: 10]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:596)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:59)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-1" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":, "age":, "sex":"M"}"; line: 1, column: 10]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:596)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:59)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-2" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:59)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-3" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":, "age":, "sex":"M"}"; line: 1, column: 10]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:596)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-4" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":, "age":, "sex":"M"}"; line: 1, column: 10]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:596)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:59)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":"alexander_pushkin", "age":, "sex":null}"; line: 1, column: 37]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":"alexander", "age":, "sex":"M"}"; line: 1, column: 29]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-5" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:59)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-6" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: (String)"{"name":"alexander", "age":, "sex":"M"}"; line: 1, column: 29]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedChar(ParserMinimalBase.java:673)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleOddValue(ReaderBasedJsonParser.java:2082)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:1026)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:59)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-7" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-8" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)) in numeric value: expected digit (0-9) to follow minus sign, for valid numeric value
 at [Source: (String)"{"name":"", "age":-, "sex":"M"}"; line: 1, column: 21]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedNumberChar(ParserMinimalBase.java:565)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleInvalidNumberStart(ReaderBasedJsonParser.java:1789)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._parseSignedNumber(ReaderBasedJsonParser.java:1513)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:983)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-9" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.core.JsonParseException: Unexpected character (',' (code 44)) in numeric value: expected digit (0-9) to follow minus sign, for valid numeric value
 at [Source: (String)"{"name":"", "age":-, "sex":"M"}"; line: 1, column: 21]
	at com.fasterxml.jackson.core.JsonParser._constructError(JsonParser.java:2418)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportError(ParserMinimalBase.java:749)
	at com.fasterxml.jackson.core.base.ParserMinimalBase._reportUnexpectedNumberChar(ParserMinimalBase.java:565)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._handleInvalidNumberStart(ReaderBasedJsonParser.java:1789)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser._parseSignedNumber(ReaderBasedJsonParser.java:1513)
	at com.fasterxml.jackson.core.json.ReaderBasedJsonParser.nextFieldName(ReaderBasedJsonParser.java:983)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer._readAndBindStringKeyMap(MapDeserializer.java:608)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:449)
	at com.fasterxml.jackson.databind.deser.std.MapDeserializer.deserialize(MapDeserializer.java:32)
	at com.fasterxml.jackson.databind.deser.DefaultDeserializationContext.readRootValue(DefaultDeserializationContext.java:323)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4730)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:55)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-10" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
com.fasterxml.jackson.databind.exc.MismatchedInputException: No content to map due to end-of-input
 at [Source: (String)""; line: 1, column: 0]
	at com.fasterxml.jackson.databind.exc.MismatchedInputException.from(MismatchedInputException.java:59)
	at com.fasterxml.jackson.databind.ObjectMapper._initForReading(ObjectMapper.java:4821)
	at com.fasterxml.jackson.databind.ObjectMapper._readMapAndClose(ObjectMapper.java:4723)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3677)
	at com.fasterxml.jackson.databind.ObjectMapper.readValue(ObjectMapper.java:3645)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:28)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
java.lang.NullPointerException: Cannot invoke "Object.toString()" because the return value of "java.util.Map.get(Object)" is null
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.checkRules(RuleProcessorImpl.java:59)
	at ru.mai.lessons.rpks.impl.RuleProcessorImpl.processing(RuleProcessorImpl.java:32)
	at ru.mai.lessons.rpks.impl.KafkaReaderImpl.processing(KafkaReaderImpl.java:62)
	at ru.mai.lessons.rpks.impl.ServiceFiltering.lambda$start$0(ServiceFiltering.java:47)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
Exception in thread "Timer-11" java.lang.IllegalStateException: DB is not ready
	at ru.mai.lessons.rpks.impl.DbReaderImpl.readRulesFromDB(DbReaderImpl.java:111)
	at ru.mai.lessons.rpks.impl.ServiceFiltering$1.run(ServiceFiltering.java:33)
	at java.base/java.util.TimerThread.mainLoop(Timer.java:566)
	at java.base/java.util.TimerThread.run(Timer.java:516)
]]></system-err>
</testsuite>
